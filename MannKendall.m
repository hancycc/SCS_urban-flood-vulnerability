[a,R] = geotiffread('C:\Users\A\Desktop\公管_返修\数据_new\UFV_VD\UFV2016.tif');
info  = geotiffinfo('C:\Users\A\Desktop\公管_返修\数据_new\UFV_VD\UFV2016.tif');
Elevation = imread('C:\Users\A\Desktop\公管_返修\数据_new\UFV_VD\UFV2016.tif');    
[m1,n1] = size(Elevation); 

sumData = [];
for year = 2012:2020
    data = imread(['C:\Users\A\Desktop\公管_返修\数据_new\UFV_VD\UFV',num2str(year),'.tif']);
    data= double(reshape(data',m1*n1,1));
    sumData = [sumData,data];
end

rowCol = zeros(m1*n1,2);
for i = 1:m1
    rowCol((i-1)*n1+1:i*n1,1)=i;
    rowCol((i-1)*n1+1:i*n1,2)=1:1:n1;
end
sumData = [rowCol,sumData];
sumData(isnan(sumData(:,end)),:)=[];
Zs = nan(length(sumData),1);
beta = nan(length(sumData),1);
UFk = nan(length(sumData),1);
UBk = nan(length(sumData),1);


for kkk = 1:length(sumData)
    ceil(kkk*100/length(sumData))
    trendData = sumData(kkk,3:end);
    trendData(isnan(trendData))=[];  
    if(length(trendData)<2)
        Zs(kkk,:) = nan;
        beta(kkk,:) = nan;        
    else
        [Zs(kkk,:),beta(kkk,:),~,~]= MKTest(trendData,length(trendData));
    end
end

Zs2 = reshape1(m1,n1,sumData(:,1:2),Zs);
fileName1 = 'C:\Users\A\Desktop\公管_返修\数据_new\9年时序\时序分析\Zc.tif';     
geotiffwrite(fileName1,Zs2,R,'GeoKeyDirectoryTag',info.GeoTIFFTags.GeoKeyDirectoryTag)
beta2 = reshape1(m1,n1,sumData(:,1:2),beta);
fileName2 = 'C:\Users\A\Desktop\公管_返修\数据_new\9年时序\时序分析\beta.tif';     
geotiffwrite(fileName2,beta2,R,'GeoKeyDirectoryTag',info.GeoTIFFTags.GeoKeyDirectoryTag)


        
        
